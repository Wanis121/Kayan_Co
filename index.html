<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kayan Co</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Arial;}
body{background:#0f172a;color:#fff;transition:.3s;}
body.light{background:#f1f5f9;color:#0f172a;}
.header{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;}
#themeBtn{font-size:22px;background:none;border:none;cursor:pointer;}
.container{padding:10px;max-width:1200px;margin:auto;display:flex;flex-wrap:wrap;gap:10px;}
.card{background:rgba(255,255,255,0.08);padding:12px;border-radius:16px;flex:1 1 280px;}
body.light .card{background:#fff;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
.title{font-size:18px;margin-bottom:5px;font-weight:600;}
table{width:100%;border-collapse:collapse;}
td{padding:6px;}
.add-btn{background:#22c55e;border:none;color:#fff;padding:8px 14px;border-radius:12px;margin-top:5px;cursor:pointer;}
.delete-btn{background:#ef4444;border:none;color:#fff;padding:6px 10px;border-radius:10px;cursor:pointer;}

/* LOGIN */
.login-box{position:fixed;inset:0;background:linear-gradient(135deg,#0f172a,#1e293b);display:flex;align-items:center;justify-content:center;z-index:9999;}
.login-card{background:rgba(255,255,255,0.08);backdrop-filter:blur(18px);padding:25px;border-radius:18px;width:100%;max-width:350px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,0.3);}
.login-card h2{margin-bottom:15px;font-weight:600}
.login-card input{width:100%;margin:10px 0;padding:12px;border-radius:12px;border:none;font-size:16px;}
.login-card button{width:100%;padding:12px;background:#22c55e;color:#fff;border:none;border-radius:12px;font-size:17px;cursor:pointer;}
.error{color:#f87171;font-size:14px;margin-top:5px;}
#lockMsg{color:#fb7185;font-size:14px;margin-top:8px;}

/* ADMIN PANEL MODAL */
#adminPanel{display:none;position:fixed;inset:0;background:#00000066;backdrop-filter:blur(20px);border-radius:20px;padding:20px;z-index:9999;overflow-y:auto;}
#adminContent{background:rgba(0,0,0,0.8);padding:20px;border-radius:20px;max-width:500px;margin:auto;}
#adminContent h3{color:#fff;margin-bottom:15px;}
#adminContent input, #adminContent textarea, #adminContent select{width:100%;padding:8px;border-radius:10px;border:none;margin:5px 0;}
#adminContent button{width:100%;padding:10px;border-radius:12px;border:none;margin:5px 0;background:#22c55e;color:#fff;cursor:pointer;}
#logModal{display:none;position:fixed;inset:0;background:#00000088;backdrop-filter:blur(20px);padding:20px;z-index:1000;}
#logContent{background:#111;padding:20px;border-radius:16px;max-width:500px;margin:auto;max-height:70vh;overflow-y:auto;color:#fff;}
body.light #logContent{background:#f1f5f9;color:#0f172a;}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="login-box" id="loginBox">
  <div class="login-card">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    <input id="user" placeholder="Username">
    <input id="pass" type="password" placeholder="Password">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    <div class="error" id="loginError"></div>
    <div id="lockMsg"></div>
  </div>
</div>

<!-- HEADER -->
<div class="header">
  <h3>Kayan Co</h3>
  <div>
    <button id="themeBtn" onclick="toggleTheme()">ğŸŒ™</button>
    <button class="add-btn" onclick="logout()">â‹ ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
  </div>
</div>

<!-- MAIN PRODUCTS -->
<div class="container" id="productContainer">
  <div class="card">
    <div class="title">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</div>
    <table id="doctorTable"></table>
  </div>
  <div class="card">
    <div class="title">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª ÙƒÙˆØ§ÙÙŠØ±Ø§Øª</div>
    <table id="salonTable"></table>
  </div>
  <div class="card">
    <div class="title">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</div>
    <table id="restaurantTable"></table>
  </div>
  <div class="card">
    <div class="title">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù…Ù„</div>
    <table id="labsTable"></table>
  </div>
</div>

<!-- ADMIN PANEL MODAL -->
<div id="adminPanel">
  <div id="adminContent">
    <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³Ø±ÙŠØ©</h3>

    <select id="selectCategory">
      <option value="doctor">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡</option>
      <option value="salon">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª ÙƒÙˆØ§ÙÙŠØ±Ø§Øª</option>
      <option value="restaurant">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</option>
      <option value="labs">Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù…Ù„</option>
    </select>
    <textarea id="newProducts" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨ØµÙŠØºØ©: Ø§Ù„Ø§Ø³Ù… : Ø§Ù„Ø³Ø¹Ø± (ÙƒÙ„ Ø³Ø·Ø± Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯)"></textarea>
    <button onclick="addProducts()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>

    <hr>
    <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h4>
    <input id="newUser" placeholder="Username">
    <input id="newPass" type="password" placeholder="Password">
    <input id="confirmPass" type="password" placeholder="Confirm Password">
    <button onclick="addNewUser()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</button>

    <hr>
    <button onclick="exportData()">ğŸ“¤ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    <button onclick="copyData()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    <button onclick="showLogs()">ğŸ“œ Ø§Ù„Ø³Ø¬Ù„</button>
    <button onclick="closeAdmin()">âŒ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù„ÙˆØ­Ø©</button>
  </div>
</div>

<!-- LOG MODAL -->
<div id="logModal">
  <div id="logContent">
    <button onclick="closeLogs()">âŒ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø³Ø¬Ù„</button>
    <pre id="logText"></pre>
  </div>
</div>

<script>
/* ===== Users ===== */
const USERS=[
  {u:"kareem m",p:"Kareem123"},
  {u:"wanis s",p:"kajo1234"}
];
const DATA_KEY="kayan_data";
const LOG_KEY="kayan_logs";
const HISTORY_KEY="kayan_history";
const LOGIN_KEY="kayan_last_login";

let data=JSON.parse(localStorage.getItem(DATA_KEY))||{doctor:[],salon:[],restaurant:[],labs:[]};
let logs=JSON.parse(localStorage.getItem(LOG_KEY))||[];
let history=JSON.parse(localStorage.getItem(HISTORY_KEY))||[];

let tries=0;

/* ===== Login ===== */
function login(){
  const userInput=document.getElementById("user").value.trim();
  const passInput=document.getElementById("pass").value;
  const now=Date.now();
  const blockedUntil=localStorage.getItem("blockedUntil")||0;

  if(now<blockedUntil){
    document.getElementById("lockMsg").textContent="â›” Ù…Ù‚ÙÙˆÙ„ Ù…Ø¤Ù‚ØªÙ‹Ø§ØŒ Ø­Ø§ÙˆÙ„ Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø©";
    return;
  }

  const ok=USERS.find(x=>x.u===userInput && x.p===passInput);
  if(ok){
    document.getElementById("loginBox").style.display="none";
    localStorage.setItem("loggedIn", userInput);
    localStorage.setItem(LOGIN_KEY,new Date().toLocaleString());
  }else{
    tries++;
    document.getElementById("loginError").textContent="âŒ Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø§Ø·Ø¦Ø©";
    if(tries>=3){
      localStorage.setItem("blockedUntil", now+60000);
      document.getElementById("lockMsg").textContent="â›” ØªÙ… ØºÙ„Ù‚ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù…Ø¯Ø© Ø¯Ù‚ÙŠÙ‚Ø©";
      tries=0;
    }
  }
}

/* ===== Logout ===== */
function logout(){
  localStorage.removeItem("loggedIn");
  location.reload();
}

/* ===== Render ===== */
function render(section){
  let t=document.getElementById(section+"Table");
  t.innerHTML="";
  data[section].forEach((x,i)=>{
    t.innerHTML+=`<tr>
      <td>${x.name}</td>
      <td>${x.price}</td>
    </tr>`;
  });
}
function renderAll(){["doctor","salon","restaurant","labs"].forEach(render)}

/* ===== Admin Panel Functions ===== */
function openAdmin(){document.getElementById("adminPanel").style.display="block";}
function closeAdmin(){document.getElementById("adminPanel").style.display="none";}

/* ===== Add Products ===== */
function addProducts(){
  const cat=document.getElementById("selectCategory").value;
  const txt=document.getElementById("newProducts").value.trim();
  if(!txt){alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª");return;}
  const lines=txt.split("\n");
  lines.forEach(line=>{
    const parts=line.split(":");
    if(parts.length<2) return;
    const name=parts[0].trim();
    const price=parts[1].trim();
    if(name && price){
      data[cat].push({name,price});
      logs.push({action:`Ø¥Ø¶Ø§ÙØ© ${name} Ø¥Ù„Ù‰ ${cat}`,time:new Date().toLocaleString()});
    }
  });
  if(history.length>=20) history.shift();
  history.push(JSON.stringify(data));
  localStorage.setItem(DATA_KEY,JSON.stringify(data));
  localStorage.setItem(LOG_KEY,JSON.stringify(logs));
  renderAll();
  document.getElementById("newProducts").value="";
  alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª");
}

/* ===== Add New User ===== */
function addNewUser(){
  const u=document.getElementById("newUser").value.trim();
  const p=document.getElementById("newPass").value;
  const c=document.getElementById("confirmPass").value;
  if(!u||!p){alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");return;}
  if(p!==c){alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ÙŠÙ†");return;}
  USERS.push({u,p});
  logs.push({action:`Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…: ${u}`,time:new Date().toLocaleString()});
  localStorage.setItem(LOG_KEY,JSON.stringify(logs));
  alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­");
  document.getElementById("newUser").value="";
  document.getElementById("newPass").value="";
  document.getElementById("confirmPass").value="";
}

/* ===== Export & Copy ===== */
function exportData(){const b=document.getElementById("newProducts");b.style.display="block";b.value=JSON.stringify(data,null,2);}
function copyData(){const b=document.getElementById("newProducts");if(!b.value){alert("Ø§Ø³ØªØ®Ø±Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹");return;}navigator.clipboard.writeText(b.value);alert("âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®");}

/* ===== Logs ===== */
function showLogs(){
  const logModal=document.getElementById("logModal");
  const logText=document.getElementById("logText");
  logText.textContent=logs.slice(-20).map(l=>`${l.time} - ${l.action}`).join("\n");
  logModal.style.display="block";
}
function closeLogs(){document.getElementById("logModal").style.display="none";}

/* ===== Theme ===== */
function toggleTheme(){
  document.body.classList.toggle("light");
  localStorage.setItem("theme",document.body.className);
  themeBtn.textContent=document.body.classList.contains("light")?"ğŸŒ":"ğŸŒ™";
}

/* ===== Init ===== */
(function init(){
  const logged=localStorage.getItem("loggedIn");
  const th=localStorage.getItem("theme");
  if(th)document.body.className=th;
  if(logged){document.getElementById("loginBox").style.display="none";}
  renderAll();
})();
</script>

</body>
</html>
