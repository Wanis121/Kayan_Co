<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Kayan_Co.Net</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="logo.png">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Tahoma;}
body{direction:rtl;background:#1c1c1c;color:#fff;padding:15px;transition:.4s ease;}
body.light{background:#f1f5f9;color:#000;}
.box{max-width:1100px;margin:auto;background:#222;padding:20px;border-radius:16px;box-shadow:0 0 20px #000;}
.top-bar{display:flex;align-items:center;justify-content:space-between;}
.logo img{width:50px}
.section{margin-top:25px;padding:15px;border-radius:16px;background:#2a2a2a;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{padding:10px;border-bottom:1px solid #333;text-align:center;}
input,select{width:100%;padding:8px;border-radius:10px;border:none;background:#333;color:#fff;margin-bottom:10px;}
button{border:none;border-radius:10px;padding:10px;width:100%;cursor:pointer;background:#00ffd5;color:#000;font-weight:bold;}
.card{background:#333;padding:10px;border-radius:10px;margin:5px}
</style>
</head>

<body>
<div class="box">

<div class="top-bar">
  <div class="logo">
    <img src="logo.png">
    <b>Kayan Co</b>
  </div>
</div>

<div class="section">
  <h2>بحث عام</h2>
  <select id="globalFilter" onchange="searchAll()">
    <option value="all">كل الأقسام</option>
    <option value="doctor">الأطباء</option>
    <option value="salon">الكوافير</option>
    <option value="restaurant">المطاعم</option>
    <option value="labs">المعامل</option>
  </select>
  <input type="text" id="globalSearch" placeholder="اكتب اسم الصنف..." oninput="searchAll()">
  <div id="globalResults"></div>
</div>

<div id="sections"></div>

</div>

<script>
let data = {};

fetch("data.json?ver=" + Date.now())
  .then(r => r.json())
  .then(json => {
    data = json;
    renderSections();
  });

function renderSections(){
  let container = document.getElementById("sections");
  container.innerHTML = "";

  for(let section in data){
    let div = document.createElement("div");
    div.className = "section";

    div.innerHTML = `<h2>${translate(section)}</h2>
    <table>
      <thead>
        <tr><th>الصنف</th><th>السعر</th></tr>
      </thead>
      <tbody id="${section}Table"></tbody>
    </table>`;

    container.appendChild(div);
    render(section);
  }
}

function render(section){
  let table = document.getElementById(section+"Table");
  table.innerHTML = "";

  data[section].forEach(item=>{
    table.innerHTML += `
      <tr>
        <td>${item.name}</td>
        <td>${item.price}</td>
      </tr>
    `;
  });
}

function searchAll(){
  let q = document.getElementById("globalSearch").value.toLowerCase();
  let filter = document.getElementById("globalFilter").value;
  let box = document.getElementById("globalResults");
  box.innerHTML = "";

  for(let section in data){
    if(filter !== "all" && filter !== section) continue;
    data[section].forEach(item=>{
      if(item.name.toLowerCase().includes(q)){
        box.innerHTML += `<div class="card">${item.name} - ${item.price}</div>`;
      }
    });
  }
}

function translate(key){
  return {
    doctor:"الأطباء",
    salon:"الكوافير",
    restaurant:"المطاعم",
    labs:"المعامل"
  }[key];
}
</script>

</body>
</html>
